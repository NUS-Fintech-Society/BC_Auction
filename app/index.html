<!-- index.html -->

<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Auction</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- CDN -->

        <!-- Bootstrap CSS only -->
        <link 
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" 
            rel="stylesheet" 
            integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" 
            crossorigin="anonymous"
        />

        <!-- Inter Font CSS -->
        <link 
            href="https://cdnjs.cloudflare.com/ajax/libs/inter-ui/3.15.0/inter.css"
            rel="stylesheet" 
            integrity="sha512-2ScEqx8oE365TaMpvEhzeFgNndX303Y62SJfTqJ7xeBUS7FV86//D1MAKOjCglApnQMteDSQzn+HqYFIFeNJrw==" 
            crossorigin="anonymous" 
        />

        <!-- jQuery JS -->
        <script 
            src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        ></script>

        <!-- Web3 JS -->
        <script 
            src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.3.0/web3.min.js"
        ></script>

        <link 
            rel="stylesheet" 
            href="./styles/styles.css"
        />
    </head>

    <body class="inter">

        <div id="alert" class="card w-auto h-auto">  
            <div id="alert-header" class="card-header">Alert</div>
            <div id="alert-body" class="card-body"></div>
            <div id="alert-btn"></div>
        </div>

        <h1><div id="root" class="p-2 m-2 invisible inter"></div></h1>
        
        <script type="module">
            import { isEthEnabled, setAccount } from "./js/startup.js";

            window.addEventListener("load", async function (_window, event) {
                console.log("sa");
                if (!isEthEnabled(window)) {
                    console.log("sfda");
                    // show prompt
                    $("#alert-body")
                        .html("Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!");
                    // clear main content
                    $("#root")
                        .html("");
                } else {
                    console.log("ssaa");
                    var network = await web3.eth.net.getNetworkType();
                    if (network !== "ropsten") {
                        
                    console.log("sssadsaa");
                        // show prompt
                        $("#alert-body")
                            .html("Please change network to the Ropsten Test Network!");
                        // clear main content
                        $("#root")
                            .html("");
                    } else {
                        setAccount(window);
                        // show main content
                        $("#alert")
                            .html("");
                        $("#root")
                            .removeClass("invisible");
                        startApp();
                    }
                }

                window.ethereum.autoRefreshOnNetworkChange = false;
                window.ethereum.on("chainChanged", () => {
                    document.location.reload();
                });

            });

            async function startApp() {
                let contractAbi = [];

                let accounts = await web3.eth.getAccounts();

                web3.eth.defaultAccount = accounts[0];

                let contractAddress = "";

                $("#root")
                    .html("App has started");

                // let contract = new web3.eth.Contract(
                //     contractAbi,
                //     contractAddress
                // );
            }
        
        </script>
    </body>
</html>
